"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.resolvePaths = void 0;
const shared_1 = require("@vuepress/shared");
const utils_1 = require("@vuepress/utils");
/**
 * Resolve relative and absolute paths according to the `base` and `filePathRelative`
 */
const resolvePaths = (rawPath, base, filePathRelative) => {
    let absolutePath;
    let relativePath;
    if (rawPath.startsWith('/')) {
        // if raw path is absolute
        if (rawPath.endsWith('.md')) {
            // if raw path is a link to markdown file
            // prepend `base` to the link
            absolutePath = utils_1.path.join(base, rawPath);
            relativePath = (0, shared_1.removeLeadingSlash)(rawPath);
        }
        else {
            // if raw path is a link to other kind of file
            // keep the link as is
            absolutePath = rawPath;
            relativePath = utils_1.path.relative(base, absolutePath);
        }
    }
    else {
        // if raw path is relative
        if (filePathRelative) {
            // if `filePathRelative` is available
            // resolve relative path according to `filePathRelative`
            relativePath = utils_1.path.join(
            // file path may contain non-ASCII characters
            utils_1.path.dirname(encodeURI(filePathRelative)), rawPath);
            // resolve absolute path according to `base`
            absolutePath = utils_1.path.join(base, relativePath);
        }
        else {
            // if `filePathRelative` is not available
            // remove leading './'
            relativePath = rawPath.replace(/^(?:\.\/)?(.*)$/, '$1');
            // just take relative link as absolute link
            absolutePath = relativePath;
        }
    }
    return {
        absolutePath,
        relativePath,
    };
};
exports.resolvePaths = resolvePaths;
